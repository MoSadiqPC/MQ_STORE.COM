{% extends 'layout.html' %}
{% block title %}{{ get_text('edit') }} {{ game.name }} - DI NIRO{% endblock %}

{% block content %}
<div class="container dashboard">
    <div class="dashboard-header" style="margin-bottom: 2rem; display: flex; justify-content: space-between; align-items: center;">
        <h1>{{ get_text('edit') }} <span>{{ game.name }}</span></h1>
        <a href="{{ url_for('dashboard') }}" class="action-btn edit-btn" style="text-decoration: none;">{{ get_text('back_to_dashboard') }}</a>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash {{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="content-section">
        <form action="{{ url_for('edit_game', game_id=game.id) }}" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label>{{ get_text('game_name') }}</label>
                <input type="text" name="name" value="{{ game.name }}" required>
            </div>
            <div class="form-group">
                <label>{{ get_text('price') }} ($)</label>
                <input type="number" step="0.01" name="price" value="{{ game.price }}" required>
            </div>
            <div class="form-group">
                <label>{{ get_text('description') }}</label>
                <input type="text" name="description" value="{{ game.description }}" required>
            </div>
            <div class="form-group">
                <label>{{ get_text('category') }}</label>
                <input type="text" name="category" value="{{ game.category }}" required>
            </div>
            <div class="form-group">
                <label>{{ get_text('game_image') }}</label>
                <p style="color: var(--text-secondary); font-size: 0.9rem;">Current Image: {{ game.image_filename }}</p>
                <img src="{{ url_for('static', filename=game.image_filename) }}?v={{ range(1, 1000) | random }}" alt="{{ game.name }}" style="width: 150px; border-radius: 8px; margin-bottom: 1rem;">
                <input type="file" name="image">
                <small style="color: var(--text-secondary);">Upload a new image only if you want to change the current one.</small>
            </div>
            <div class="form-group">
                <label>{{ get_text('game_username') }}</label>
                <input type="text" name="game_username" value="{{ game.game_username or '' }}">
            </div>
            <div class="form-group">
                <label>{{ get_text('game_password') }}</label>
                <input type="text" name="game_password" value="{{ game.game_password or '' }}">
            </div>
            <div class="form-group" style="display: flex; align-items: center; gap: 10px;">
                <input type="checkbox" id="is_free" name="is_free" style="width: auto;" {% if game.is_free %}checked{% endif %}>
                <label for="is_free" style="margin-bottom: 0;">{{ get_text('is_free_game') }}</label>
            </div>
            <button type="submit" class="submit-btn">{{ get_text('update_game_btn') }}</button>
        </form>
    </div>
</div>
{% endblock %}